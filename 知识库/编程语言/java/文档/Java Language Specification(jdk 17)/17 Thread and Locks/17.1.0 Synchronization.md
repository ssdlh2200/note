# Synchronization
## 执行原理
Java中的同步机制(synchronization)是通过monitor实现的
- Java中每个对象升级为重量级锁后可以关联monitor
- 一个线程可以持有或者释放这个monitor
    - 持有monitor.owner
    - 释放lock.wait()，进入entrylist自动释放锁
- 同一时间只有一个线程可以持有该monitor的锁，其它线程获取会被阻塞
    - monitor.owner只能指向一个线程
    - 其他线程获取会进入waitset等待
- 同一个线程可以多次锁定同一个monitor，每次解锁只需要撤销一次锁定
synchronized 会先将对象升级为重量级锁，此时object header会指向monitor，然后尝试获取monitor.owner直到获取成功才会继续执行语句块内的内容（无论语句块时正常结束还是异常结束，锁都会被释放）
## Object Header
